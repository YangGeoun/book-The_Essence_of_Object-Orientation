### 협력부터 고려해라

개인이 처해있는 정황 또는 문맥에 따라 행동이 정해지듯이

객체도 상태와 행위를 먼저 정하는것 보다 객체가 어떤 협력에 속해있는지를 결정하고

그거에 맞춰서 객체의 행위와 상태를 정의한다.

여기서도 앞선 챕터에서 볼 수 있듯, 상태를 먼저 정의하지말고 행위를 그다음으로 정의하고, 행위에 필요한 상태를 정의해서

자율적인 객체를 만들고 충분히 협력적인 객체를 만든다.

## 협력

재판 예시에서 왕과 왕비, 흰 토끼, 앨리스, 모자장수들은 각각 객체이다.

객체지향을 한다는 것은 시스템을 만드는데 공동의 목표가 있고, 해당 공동의 목표를 이루기 위한 자율적인 객체들의 공동체

그러면 이들의 공동 목표는 재판이라는 것이고, 재판이라는 **협력**을 이루기 위한 공동체로서 각각의 객체들이 있다.

그리고 이들이 **협력**을 위해서 객체들 사이에 요청과 응답이 오가는데

특정 객체가 일을 처리할 수 있다는 것은 해당 객체가 요청을 처리할 수 있는 적절한 지식과 행동방식을 갖고 있다는 것

그러고 이러한 요청과 응답은 객체가 수행할 **책임**이 된다.

## 책임

객체지향의 세계에서 어떤 객체가 어떤 요청에 대해 응답을 보내거나, 적절한 행동을 할 **의무**가 있는 경우

해당 객체가 **책임**을 가진다고 한다.

즉, 위의 예시에서 **재판** 이라는 협력 속에서 서로 요청과 응답을 주고받는 객체들이 있고

여기서 특정한 요청을 응답해야하는 객체는 곧 그 객체의 **책임**이 된다는 것이다.

```
왕: 재판에 대한 요청을 응답할 의무가 있기에 재판을 수행해야함

하얀토끼: 목격자를 불러오른 요청에 응답하기 위해 목격자를 증인석에 앉히고, 증언하게 해야함

모자 장수: 증언을 하라는 요청에 응답하고 증인석에 앉으라는 요청에 응답하기 위해, 증언을 할 의무와 증인석에 앉을 의무가 있음
```

여기서 책임을 어떻게 구현할 것인가에 매몰되면, 협력적이지 않은 비 자율적인 객체를 낳게 된다.

### 책임의 분류

객체의 책임은 결국 객체가 무엇을 알고있는가? 와 무엇을 할 수 있는가? 로 구성된다.

이거에 따라 객체의 책임을 크게 "하는 것" 과 "아는 것"으로 나눌 수 있다.

- 하는 것

  - 객체 생성등에 스스로 하는 행동
  - 다른 객체의 행동을 시작시키는것
  - 다른 객체의 활동을 제어하고 조율하는것

- 아는 것

  - 개인적인 정보에 관해 아는것
  - 해당 책임을 수행하는 등의 관련된 객체에 대해 아는것
  - 자신이 유도하거나 계산할수 있는것에관해 아는것

정리하자면

책임은 객체의 외부에 제공해 줄 수 있는 정보(아는것의 측면)와 외부에 제공해 줄 수 있는 서비스(하는 것의 측면)의 목록이다.

이거에 따라서 책임은 객체의 공용 인터페이스를 구성하게 된다.

### 책임과 메시지

협력 안에서 객체는 다른 객체로부터 요청이 전송됐을 경우에만 자신에게 주어진 책임을 수행한다.

여기서 다른객체에게 주어진 책임을 수행하도록 요청하는 것을 메세지 전송이라고 한다.

책임이 협력속의 메세지 수신자 입장에서 '무엇을 할 수 있는지?'를 나열하는거라면

메세지는 협력에 참여하는 두 객체 사이의 관계를 강조한 것이다.

왕과 모자장수 예시에서 보면, 증언하라 메세지를 수신하는 모자장수에게는 증언을 한다는 `할수있는 무엇`을 나열할 수 있다.

즉, 증언하라 라는 책임을 수행하기 위해 어쨋든 모자장수 스스로하는것이 아닌 왕이 메세지줘야 하는것이고

이러한 책임을 수행하기 위해 메세지를 주고받는 관계는 왕과 모자장수라는 것

한가지 주의 할 점은 책임과 메세지의 수준을 같은 선상으로 보면 안된다는 것

## 역할

각각의 등장인물(객체)들이 재판(협력)을 수행하기 위해 의무(책임)이 있고

서로 요청과 응답(메세지)를 주고받음으로서 책임을 완수하고 있다는것을 확인할 수 있다.

여기서 객체가 책임을 가진다는것이 바로 **역할**이 된다.

결론적으로 어떤 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행하는 역할을 암시한다.

여기서 엘리스가 이야기 도중에 참여하여 목격자의 역할을 수행하는 것을 보면

같은 역할을 수행할 수 있는 객체가 있을 수 있다는 것

예시를 살펴보면 판사의 역할을 수행하는 객체는 왕, 왕비

증인의 역할을 수행하는 객체는 엘리스 모자장수, 목격자를 데려오는 역할을 수행하는 하얀토끼로 볼 수 있다.

판사가 왕비로 바뀌더라도 하얀토끼에게 증인을 증언석에 앉히라는 것과, 증인에게 증언하라고 시키는건 변함이 없다.

여기서 판사의 역할을 수행하는 인물을 왕에서 왕비로 바꾼다 하더라도 '판사' 라는 추상화된 역할로 포장할 수 있다.

결국 예시에서 '재판에서 왕과 왕비는 판사의 역할을 수행할 수 있다' 라고 볼 수 있고

이를 해석하면 재판(협력) 속에서 서로다른 객체(왕과 왕비)가 같은 역할(판사)를 수행할 수 있고, 그 말은 즉

**같은 역할**을 맡은 객체들은 **협력**속에서 **같은 책임의 집합**을 수행한다는 것이 된다.

역할은 객체지향에서 `단순성`, `유연성` `재사용성`을 뒷받침하는 핵심 개념이다.

### 대체 가능성과 역할

여러 객체들이 같은 협력속에 같은 역할을 수행한다는 것은 곧

같은 책임의 집합을 수행한다는 것이다.

이걸 좀 더 아래 레벨로 보자면, 결국 같은 역할을 수행하는 객체들끼리의 **행동** 서로 호환되어야 한다.

또한 하나의 객체는 하나의 역할만 수행하진 않는다.

위의 예시에서 모자장수의 역할이 비록 재판이라는 협력속에서는 증인이라는 역할을 수행해야 하지만

본인이름에서 알수 있듯, '모자 장수' 로서의 책임도 있을 것이며 책임의 예시로는 모자를 판매하다 등이 있을것이다.

따라서 대부분의 경우 객체의 `타입`과 `역할` 사이에는 **일반화/특수화** 관계가 성립하는 것이 일반적이다.

## 객체의 모양을 결정하는 협력

객체지향 시스템을 구축하는데 있어서, 너무 정적인 측면(클래스와 일부 다이어그램)에만 집중을 하게 되면 객체를 독립적으로 볼 수 밖에 없다.

예를들어 왕을 정적인 측면에서의 왕만 모델링 한다고 하면

왕의 평균적인 용모나 행동에만 집중할 것이다. 이러면 왕 이라는 객체를 고립시키는 것이다.

그래서 어떤 문맥 즉, 협력에 처해 있고 그 안에서 어떤 역할을 수행하는 객체인지를 먼저 생각해야 한다.

### 협력을 따라 흐르는 책임

객체를 설계하기에 먼저 견고하고 깔끔한 협력을 설계해야 한다.

협력을 설계한다는 것은 설계에 참여하는 객체들이 주고받을 요청과 응답의 흐름을 결정한다.

요청과 응답은 곧 책임이 되고, 책임이 결정되면 해당 책임을 수행할 객체를 선정하고

그 객체가 해당 책임을 수행하기 위해 필요한 데이터나 행동이 결정되고 나면 구현하러 가는것

즉, 협력먼저 그다음 협력에 필요한 책임 그다음 책임을 받을 객체 그다음 책임을 수행하기 위한 데이터와 행동 선정

그 다음에서야 구현을 고민하고 클래스를 고민하는것이다.
